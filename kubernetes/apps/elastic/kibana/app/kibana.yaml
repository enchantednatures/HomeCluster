---
apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: kibana
  namespace: elastic
spec:
  version: 9.0.0
  count: 1
  elasticsearchRef:
    name: elasticsearch
  config:
    server.publicBaseUrl: "https://kibana.${SECRET_DOMAIN}"
    xpack.security.authc.providers:
      oidc.authentik:
        order: 0
        description: "Login with Authentik"
        realm: authentik
        icon: "https://auth.${SECRET_DOMAIN}/static/dist/assets/icons/icon_left_brand.svg"
      basic.basic1:
        order: 1
  podTemplate:
    metadata:
      labels:
        app: kibana
    spec:
      containers:
        - name: kibana
          resources:
            requests:
              memory: 1Gi
              cpu: 0.5
            limits:
              memory: 2Gi
              cpu: 2
