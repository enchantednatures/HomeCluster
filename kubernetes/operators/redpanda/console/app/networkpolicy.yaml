# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/networking.k8s.io/v1/networkpolicy.json
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: console
  namespace: redpanda
  labels:
    app.kubernetes.io/name: console
spec:
  podSelector:
    matchLabels:
      app.kubernetes.io/name: console
  policyTypes:
    - Ingress
    - Egress
  ingress:
    # Allow traffic from Istio gateway
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: istio-ingress
      ports:
        - protocol: TCP
          port: 8080
    # Allow traffic from Tailscale proxies in networking namespace
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: networking
      ports:
        - protocol: TCP
          port: 8080
    # Allow traffic from same namespace
    - from:
        - namespaceSelector:
            matchLabels:
              kubernetes.io/metadata.name: redpanda
  egress:
    # Allow all egress traffic
    - to: []
      ports:
        - protocol: TCP
        - protocol: UDP
